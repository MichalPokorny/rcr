#!/usr/bin/ruby -w
require 'rcr/easy'
require 'rcr/letter_classifier/neural'
require 'rcr/marshal'

classifier = RCR.build_letter_classifier
# classifier = RCR::Marshal.load(File.join(RCR::Config.trained_path, "letter-classifier-oversegmentation"))
# classifier = RCR::LetterClassifier::Neural.load_internal(File.join(RCR::Config.trained_path, "letter-classifier-oversegmentation"))
dataset = RCR::LetterClassifier::Neural.load_dataset(RCR::Config.prepared_letter_data_path)
dataset = dataset.restrict_keys(('A'..'Z').map(&:ord))
puts "Classifier evaluation: %.2f" % classifier.evaluate(dataset)
